!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){t.cxSelect=function(e){for(var n,e,s={dom:{},api:{}},i=function(t){return!(!t||"function"!=typeof HTMLElement&&"object"!=typeof HTMLElement||!(t instanceof HTMLElement))||!(!t||!t.nodeType||1!==t.nodeType)},r=function(t){return!!(t&&t.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&t instanceof jQuery)},o=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},a=0,l=arguments.length;a<l;a++)r(arguments[a])?n=arguments[a]:i(arguments[a])?n=t(arguments[a]):"object"==typeof arguments[a]&&(e=arguments[a]);if(!(n.length<1))return s.init=function(){var s=this;if(s.dom.box=n,s.settings=t.extend({},t.cxSelect.defaults,e,{url:s.dom.box.data("url"),nodata:s.dom.box.data("nodata"),required:s.dom.box.data("required"),firstTitle:s.dom.box.data("firstTitle"),firstValue:s.dom.box.data("firstValue")}),s.settings.selects.length){s.selectArray=[],s.selectSum=s.settings.selects.length;for(var i=0;i<s.selectSum&&s.dom.box.find("select."+s.settings.selects[i]);i++)s.selectArray.push(s.dom.box.find("select."+s.settings.selects[i]));s.selectSum=s.selectArray.length,s.selectSum&&("string"==typeof s.settings.url?t.getJSON(s.settings.url,function(t){s.dataJson=t,s.buildContent()}):"object"==typeof s.settings.url&&(s.dataJson=s.settings.url,s.buildContent()))}},s.getIndex=function(t){return this.settings.required?t:t-1},s.getNewOptions=function(e,n){if(e){var s=this.settings.firstTitle,i=this.settings.firstValue,r=e.data("firstTitle"),o=e.data("firstValue"),a="";return"string"!=typeof r&&"number"!=typeof r&&"boolean"!=typeof r||(s=r.toString()),"string"!=typeof o&&"number"!=typeof o&&"boolean"!=typeof o||(i=o.toString()),this.settings.required||(a='<option value="'+i+'">'+s+"</option>"),t.each(n,function(t,e){a+="string"==typeof e.v||"number"==typeof e.v||"boolean"==typeof e.v?'<option value="'+e.v+'">'+e.n+"</option>":'<option value="'+e.n+'">'+e.n+"</option>"}),a}},s.buildContent=function(){var t=this;t.dom.box.on("change","select",function(){t.selectChange(this.className)});var e=t.getNewOptions(t.selectArray[0],t.dataJson);t.selectArray[0].html(e).prop("disabled",!1).trigger("change"),t.setDefaultValue()},s.setDefaultValue=function(t){t=t||0;var e,n=this;t>=n.selectSum||!n.selectArray[t]||(e=n.selectArray[t].data("value"),"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e||(e=e.toString(),setTimeout(function(){n.selectArray[t].val(e).trigger("change"),t++,n.setDefaultValue(t)},1)))},s.selectChange=function(t){t=t.replace(/ /g,","),t=","+t+",";for(var e,n,s,i,r=[],a=0;a<this.selectSum;a++)r.push(this.getIndex(this.selectArray[a].get(0).selectedIndex)),"number"==typeof e&&a>e&&(this.selectArray[a].empty().prop("disabled",!0),"none"===this.settings.nodata?this.selectArray[a].css("display","none"):"hidden"===this.settings.nodata&&this.selectArray[a].css("visibility","hidden")),t.indexOf(","+this.settings.selects[a]+",")>-1&&(e=a);n=e+1,s=this.dataJson;for(var a=0;a<n;a++){if("undefined"==typeof s[r[a]]||o(s[r[a]].s)===!1||!s[r[a]].s.length)return;s=s[r[a]].s}this.selectArray[n]&&(i=this.getNewOptions(this.selectArray[n],s),this.selectArray[n].html(i).prop("disabled",!1).css({display:"",visibility:""}).trigger("change"))},s.init(),this},t.cxSelect.defaults={selects:[],url:null,nodata:null,required:!1,firstTitle:"请选择",firstValue:"0"},t.fn.cxSelect=function(e,n){return this.each(function(s){t.cxSelect(this,e,n)}),this}});